package com.aclass.run;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class EmployeeInsert {
	
	public static void main(String[] args) {
		
		Connection conn = null;
		Statement stmt = null;
		int result = 0;
		
		Scanner sc = new Scanner(System.in);
		
		System.out.print("사번을 입력해주세요 > ");
		int empId = sc.nextInt();
		sc.nextLine();
		
		System.out.print("사원 이름을 입력해주세요 > ");
		String empName = sc.nextLine();
		
		System.out.print("주민등록 번호를 입력해주세요 >");
        String empNo = sc.nextLine();
        
        System.out.print("이메일을 입력해주세요 > ");
        String email = sc.nextLine();
        
        System.out.print("휴대폰 전화번호를 입력해주세요 > ");
        String phone = sc.nextLine();
        
        System.out.print("부서 코드를 입력해주세요 > ");
        String deptCode = sc.nextLine();
        
        System.out.print("직급 코드를 입력해주세요 > ");
        String jobCode = sc.nextLine();
        
        System.out.print("급여 등급을 입력해주세요 > ");
        String salLevel = sc.nextLine();
        
        System.out.print("직원 급여를 입력해주세요 > ");
        int salary = sc.nextInt();
        sc.nextLine();
        
        System.out.print("급여 보너스율을 입력해주세요 > ");
        double bonus = sc.nextDouble();
        sc.nextLine();
        
        System.out.print("사수 사번을 입력해주세요 > ");
        int managerId = sc.nextInt();
        sc.nextLine();
        
        System.out.print("재직 여부 (N(재직중) / Y(퇴사))");
        char entYn = sc.nextLine().charAt(0);
        
        String sql = "INSERT " 
        		     + "INTO " 
        		     +        "EMPLOYEE " 
        		     +"VALUES ("
        		     +         empId
        		     +  ", '"+ empName + "'"
        		     +  ", '"+ empNo   + "'"
        		     +  ", '"+ email   + "'"
        		     +  ", '"+ phone   + "'"
        		     +  ", '"+ deptCode + "'"
        		     +  ", '"+ jobCode + "'"
        		     +  ", '"+ salLevel + "'"
        		     +  ", " + salary 
        		     +  ", " + bonus  
        		     +  ", '"+ managerId + "'"
        		     +  ", SYSDATE, "
        		     +  ", '" + entYn + "')";
        
        try {
        	Class.forName("oracle.jdbc.driver.OracleDriver");
        	System.out.println("Driver등록 성공!");
        	
        	conn = DriverManager.getConnection("jdbc:oracle:thin:@115.90.212.20:10000:XE",
        			                           "BJG12",
        			                           "BJG121234");
        	System.out.println("DB서버 접속 성공!");
        	
        	stmt = conn.createStatement();
        	System.out.println("Statement 객체 생성!");
        	
        	result = stmt.executeUpdate(sql);
        	System.out.println("SQL문 실행 성공!");
        	
        } catch(ClassNotFoundException e) {
        	e.printStackTrace();
        } catch(SQLException e) {
        	e.printStackTrace();
        } finally {
        	try {
        		stmt.close();
        		conn.close();
        	} catch(SQLException e) {
        		e.printStackTrace();
        	}
        }
	}

}
